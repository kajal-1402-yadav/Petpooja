<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PETPOJA - AI Smart Kitchen System</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2E7D32;
            --accent-color: #8BC34A;
            --dark-color: #1B5E20;
            --light-color: #DCEDC8;
            --danger-color: #F44336;
            --warning-color: #FFC107;
            --text-color: #333;
            --light-text: #f5f5f5;
            --card-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--text-color);
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .logo span {
            color: var(--light-color);
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 1.5rem;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        nav ul li a:hover {
            color: var(--light-color);
            text-decoration: underline;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        
        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            background-color: var(--light-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 1rem 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #eee;
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 5px;
        }
        
        .alert {
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .alert-warning {
            background-color: #FFF3E0;
            color: #E65100;
            border-left: 4px solid var(--warning-color);
        }
        
        .alert-danger {
            background-color: #FFEBEE;
            color: #C62828;
            border-left: 4px solid var(--danger-color);
        }
        
        .alert-icon {
            margin-right: 1rem;
            font-size: 1.5rem;
        }
        
        .inventory-list {
            list-style: none;
        }
        
        .inventory-item {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .inventory-item:last-child {
            border-bottom: none;
        }
        
        .item-name {
            font-weight: 500;
        }
        
        .item-status {
            font-size: 0.8rem;
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
        }
        
        .status-good {
            background-color: #E8F5E9;
            color: var(--secondary-color);
        }
        
        .status-warning {
            background-color: #FFF8E1;
            color: #FF8F00;
        }
        
        .status-danger {
            background-color: #FFEBEE;
            color: var(--danger-color);
        }
        
        .chart-container {
            height: 300px;
            margin-top: 1rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            color: var(--dark-color);
        }
        
        .menu-suggestions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .menu-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .menu-image {
            height: 150px;
            background-color: #eee;
            background-size: cover;
            background-position: center;
        }
        
        .menu-content {
            padding: 1rem;
        }
        
        .menu-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .menu-ingredients {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .menu-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }
        
        .menu-cost {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .menu-profit {
            color: var(--secondary-color);
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-outline:hover {
            background-color: var(--light-color);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .camera-container {
            width: 100%;
            height: 300px;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
            border-radius: 4px;
            background-color: #f0f0f0;
        }
        
        .camera-feed {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }
        
        .camera-canvas {
            width: 100%;
            height: 100%;
            display: none;
        }
        
        .camera-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #999;
            text-align: center;
            padding: 1rem;
        }
        
        .camera-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .detected-items {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .detected-tag {
            background-color: var(--light-color);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
        }
        
        .detected-tag.low-confidence {
            opacity: 0.7;
            border: 1px dashed var(--warning-color);
        }
        
        .detected-tag .confidence-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
        }
        
        .detected-tag.low-confidence .confidence-indicator {
            background-color: var(--warning-color);
        }
        
        .scanning-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 10;
        }
        
        .scanning-animation {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .quantity-adjust {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .quantity-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: none;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .quantity-input {
            width: 40px;
            text-align: center;
            padding: 0.2rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .detection-box {
            position: absolute;
            border: 2px solid;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
            color: white;
            text-shadow: 0 0 2px black;
        }
        
        .detection-label {
            background-color: rgba(0,0,0,0.5);
            padding: 2px 4px;
            border-radius: 4px;
            margin-top: 2px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            nav ul {
                display: none;
            }
            
            .menu-suggestions {
                grid-template-columns: 1fr;
            }
            
            .camera-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            PET<span>POJA</span>
        </div>
        <nav>
            <ul>
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#inventory">Inventory</a></li>
                <li><a href="#menu">Menu</a></li>
                <li><a href="#waste">Waste Analysis</a></li>
            </ul>
        </nav>
    </header>
    
    <div class="container">
        <section id="dashboard">
            <h1 class="section-title">Smart Kitchen Dashboard</h1>
            
            <div class="dashboard">
                <!-- Inventory Status Card -->
                <div class="card stat-card">
                    <div class="card-header">
                        <div class="card-title">Inventory Status</div>
                        <div class="card-icon">📊</div>
                    </div>
                    <div class="stat-value">78%</div>
                    <div class="stat-label">Optimal stock level</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 78%"></div>
                    </div>
                </div>
                
                <!-- Waste Reduction Card -->
                <div class="card stat-card">
                    <div class="card-header">
                        <div class="card-title">Waste Reduction</div>
                        <div class="card-icon">♻️</div>
                    </div>
                    <div class="stat-value">32%</div>
                    <div class="stat-label">Less waste this month</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 32%"></div>
                    </div>
                </div>
                
                <!-- Cost Savings Card -->
                <div class="card stat-card">
                    <div class="card-header">
                        <div class="card-title">Cost Savings</div>
                        <div class="card-icon">💰</div>
                    </div>
                    <div class="stat-value">$1,245</div>
                    <div class="stat-label">Saved this month</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Alerts Section -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Alerts & Notifications</div>
                </div>
                <div class="alert alert-danger">
                    <div class="alert-icon">⚠️</div>
                    <div>
                        <strong>3 items near expiration</strong>
                        <p>Tomatoes, Milk, and Chicken will expire in 1-2 days</p>
                    </div>
                </div>
                <div class="alert alert-warning">
                    <div class="alert-icon">ℹ️</div>
                    <div>
                        <strong>Inventory replenishment needed</strong>
                        <p>Onions and Potatoes are below optimal levels</p>
                    </div>
                </div>
            </div>
            
            <!-- Inventory Overview -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Inventory Overview</div>
                    <button class="btn btn-outline" id="scanInventoryBtn">Scan Inventory</button>
                </div>
                <ul class="inventory-list">
                    <li class="inventory-item">
                        <span class="item-name">Tomatoes</span>
                        <span class="item-status status-danger">Expiring tomorrow</span>
                    </li>
                    <li class="inventory-item">
                        <span class="item-name">Chicken Breast</span>
                        <span class="item-status status-danger">Expiring in 2 days</span>
                    </li>
                    <li class="inventory-item">
                        <span class="item-name">Milk</span>
                        <span class="item-status status-danger">Expiring tomorrow</span>
                    </li>
                    <li class="inventory-item">
                        <span class="item-name">Onions</span>
                        <span class="item-status status-warning">Low stock</span>
                    </li>
                    <li class="inventory-item">
                        <span class="item-name">Potatoes</span>
                        <span class="item-status status-warning">Low stock</span>
                    </li>
                    <li class="inventory-item">
                        <span class="item-name">Rice</span>
                        <span class="item-status status-good">In stock</span>
                    </li>
                </ul>
            </div>
        </section>
        
        <section id="inventory">
            <h1 class="section-title">Smart Inventory Management</h1>
            
            <div class="dashboard">
                <!-- Inventory Tracking -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Visual Inventory Tracking</div>
                    </div>
                    <div class="camera-container">
                        <video id="inventoryCameraFeed" class="camera-feed" playsinline></video>
                        <canvas id="inventoryCameraCanvas" class="camera-canvas"></canvas>
                        <div class="camera-placeholder">
                            <p>Camera feed will appear here when active</p>
                            <button class="btn btn-primary" id="startInventoryCamera">Start Camera</button>
                        </div>
                        <div class="scanning-overlay">
                            <div class="scanning-animation"></div>
                            <p>Analyzing inventory...</p>
                        </div>
                    </div>
                    <div class="camera-controls">
                        <button class="btn btn-outline" id="captureInventoryBtn" disabled>Capture Image</button>
                        <button class="btn btn-primary" id="analyzeInventoryBtn" disabled>Analyze Items</button>
                    </div>
                    <div class="detected-items" id="inventoryDetectedItems">
                        <span class="detected-tag">Tomatoes (5) <span class="confidence-indicator"></span></span>
                        <span class="detected-tag low-confidence">Onions (10) <span class="confidence-indicator"></span></span>
                        <span class="detected-tag">Chicken (3 packs) <span class="confidence-indicator"></span></span>
                        <span class="detected-tag">Milk (2 bottles) <span class="confidence-indicator"></span></span>
                    </div>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" id="updateInventoryBtn">Update Inventory</button>
                </div>
                
                <!-- Food Spoilage Detection -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Food Spoilage Detection</div>
                    </div>
                    <div class="camera-container">
                        <video id="spoilageCameraFeed" class="camera-feed" playsinline></video>
                        <canvas id="spoilageCameraCanvas" class="camera-canvas"></canvas>
                        <div class="camera-placeholder">
                            <p>Spoilage detection camera feed</p>
                            <button class="btn btn-primary" id="startSpoilageCamera">Start Camera</button>
                        </div>
                        <div class="scanning-overlay">
                            <div class="scanning-animation"></div>
                            <p>Checking for spoilage...</p>
                        </div>
                    </div>
                    <div class="camera-controls">
                        <button class="btn btn-outline" id="captureSpoilageBtn" disabled>Capture Image</button>
                        <button class="btn btn-primary" id="analyzeSpoilageBtn" disabled>Analyze Items</button>
                    </div>
                    <div class="alert alert-warning" style="margin-top: 1rem;" id="spoilageAlert">
                        <div class="alert-icon">⚠️</div>
                        <div>
                            <strong>Potential spoilage detected</strong>
                            <p>2 tomatoes show signs of spoilage</p>
                        </div>
                    </div>
                    <button class="btn btn-outline" style="width: 100%; margin-top: 1rem;" id="markSpoiledBtn">Mark as Spoiled</button>
                </div>
            </div>
            
            <!-- Inventory Chart -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Inventory Levels Over Time</div>
                </div>
                <div class="chart-container" id="inventoryChart">
                    <!-- Chart will be rendered here by JavaScript -->
                </div>
            </div>
        </section>
        
        <section id="menu">
            <h1 class="section-title">AI Menu Optimization</h1>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Recommended Dishes for Today</div>
                    <button class="btn btn-primary" id="generateMenuBtn">Generate New Suggestions</button>
                </div>
                <div class="menu-suggestions">
                    <!-- Menu Item 1 -->
                    <div class="menu-card">
                        <div class="menu-image" style="background-image: url('https://images.unsplash.com/photo-1518779578993-ec3579fee39f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="menu-content">
                            <h3 class="menu-title">Tomato Basil Pasta</h3>
                            <p class="menu-ingredients">Uses: Tomatoes (expiring), Basil, Pasta</p>
                            <div class="menu-stats">
                                <span class="menu-cost">Cost: $3.20</span>
                                <span class="menu-profit">Profit: $8.80</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Menu Item 2 -->
                    <div class="menu-card">
                        <div class="menu-image" style="background-image: url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="menu-content">
                            <h3 class="menu-title">Chicken Alfredo</h3>
                            <p class="menu-ingredients">Uses: Chicken (expiring), Cream, Pasta</p>
                            <div class="menu-stats">
                                <span class="menu-cost">Cost: $4.50</span>
                                <span class="menu-profit">Profit: $10.50</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Menu Item 3 -->
                    <div class="menu-card">
                        <div class="menu-image" style="background-image: url('https://images.unsplash.com/photo-1563805042-7684c019e1cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="menu-content">
                            <h3 class="menu-title">Berry Yogurt Parfait</h3>
                            <p class="menu-ingredients">Uses: Milk (expiring), Berries, Granola</p>
                            <div class="menu-stats">
                                <span class="menu-cost">Cost: $2.10</span>
                                <span class="menu-profit">Profit: $5.90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Cost Optimization -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Menu Cost Optimization</div>
                </div>
                <div class="chart-container" id="menuCostChart">
                    <!-- Chart will be rendered here by JavaScript -->
                </div>
            </div>
        </section>
        
        <section id="waste">
            <h1 class="section-title">Waste Analysis & Reporting</h1>
            
            <div class="dashboard">
                <!-- Waste Breakdown -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Waste Breakdown</div>
                    </div>
                    <div class="chart-container" id="wasteChart">
                        <!-- Chart will be rendered here by JavaScript -->
                    </div>
                </div>
                
                <!-- Waste Heatmap -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Waste Heatmap</div>
                    </div>
                    <div class="chart-container" id="heatmapChart">
                        <!-- Chart will be rendered here by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Loss-to-Profit Dashboard -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Loss-to-Profit Analysis</div>
                </div>
                <div class="chart-container" id="profitChart">
                    <!-- Chart will be rendered here by JavaScript -->
                </div>
            </div>
        </section>
    </div>
    
    <!-- Scan Inventory Modal -->
    <div class="modal" id="scanModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Scan Inventory</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Select Storage Area</label>
                    <select class="form-control" id="storageLocation">
                        <option>Refrigerator - Main</option>
                        <option>Refrigerator - Backup</option>
                        <option>Dry Storage - Shelf A</option>
                        <option>Dry Storage - Shelf B</option>
                        <option>Freezer</option>
                    </select>
                </div>
                <div class="camera-container">
                    <video id="modalCameraFeed" class="camera-feed" playsinline></video>
                    <canvas id="modalCameraCanvas" class="camera-canvas"></canvas>
                    <div class="camera-placeholder">
                        <p>Camera feed for scanning</p>
                        <button class="btn btn-primary" id="startModalCamera">Start Camera</button>
                    </div>
                    <div class="scanning-overlay">
                        <div class="scanning-animation"></div>
                        <p>Scanning inventory...</p>
                    </div>
                </div>
                <div class="camera-controls">
                    <button class="btn btn-outline" id="captureModalBtn" disabled>Capture Image</button>
                    <button class="btn btn-primary" id="scanModalBtn" disabled>Start Scanning</button>
                </div>
                <div class="detected-items" id="modalDetectedItems"></div>
            </div>
        </div>
    </div>
    
    <!-- Quantity Adjustment Modal -->
    <div class="modal" id="quantityModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adjust Quantity</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" id="quantityItemName">Tomatoes</label>
                    <div class="quantity-adjust">
                        <button class="quantity-btn" id="decreaseQuantity">-</button>
                        <input type="number" class="quantity-input" id="quantityInput" value="5" min="0">
                        <button class="quantity-btn" id="increaseQuantity">+</button>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" id="saveQuantityBtn">Save Changes</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Chart.js for all our dashboard charts
        document.addEventListener('DOMContentLoaded', function() {
            // Inventory Chart
            const inventoryCtx = document.getElementById('inventoryChart').getContext('2d');
            const inventoryChart = new Chart(inventoryCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    datasets: [
                        {
                            label: 'Tomatoes',
                            data: [65, 59, 80, 81, 56, 55, 40],
                            borderColor: '#FF6384',
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Chicken',
                            data: [28, 48, 40, 19, 86, 27, 90],
                            borderColor: '#36A2EB',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Onions',
                            data: [45, 25, 60, 31, 56, 75, 30],
                            borderColor: '#FFCE56',
                            backgroundColor: 'rgba(255, 206, 86, 0.1)',
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Menu Cost Chart
            const menuCostCtx = document.getElementById('menuCostChart').getContext('2d');
            const menuCostChart = new Chart(menuCostCtx, {
                type: 'bar',
                data: {
                    labels: ['Pasta Dish', 'Chicken Dish', 'Salad', 'Dessert', 'Soup'],
                    datasets: [
                        {
                            label: 'Cost',
                            data: [3.2, 4.5, 2.8, 2.1, 3.0],
                            backgroundColor: 'rgba(75, 192, 192, 0.6)'
                        },
                        {
                            label: 'Price',
                            data: [12, 15, 10, 8, 11],
                            backgroundColor: 'rgba(54, 162, 235, 0.6)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Waste Chart
            const wasteCtx = document.getElementById('wasteChart').getContext('2d');
            const wasteChart = new Chart(wasteCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Spoilage', 'Over-Portioning', 'Preparation Waste', 'Plate Waste'],
                    datasets: [{
                        data: [45, 25, 20, 10],
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // Heatmap Chart
            const heatmapCtx = document.getElementById('heatmapChart').getContext('2d');
            const heatmapChart = new Chart(heatmapCtx, {
                type: 'bar',
                data: {
                    labels: ['Prep Station', 'Cooking Station', 'Plating Station', 'Storage'],
                    datasets: [{
                        label: 'Waste Amount',
                        data: [12, 19, 8, 15],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.6)',
                            'rgba(54, 162, 235, 0.6)',
                            'rgba(255, 206, 86, 0.6)',
                            'rgba(75, 192, 192, 0.6)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Profit Chart
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            const profitChart = new Chart(profitCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    datasets: [
                        {
                            label: 'Food Waste Cost',
                            data: [1200, 1900, 1500, 1800, 1000, 800, 600],
                            borderColor: '#FF6384',
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Profit',
                            data: [8500, 9200, 8800, 9500, 9800, 10200, 11000],
                            borderColor: '#4BC0C0',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // Camera functionality
            const inventoryCameraFeed = document.getElementById('inventoryCameraFeed');
            const inventoryCameraCanvas = document.getElementById('inventoryCameraCanvas');
            const spoilageCameraFeed = document.getElementById('spoilageCameraFeed');
            const spoilageCameraCanvas = document.getElementById('spoilageCameraCanvas');
            const modalCameraFeed = document.getElementById('modalCameraFeed');
            const modalCameraCanvas = document.getElementById('modalCameraCanvas');
            
            const startInventoryCameraBtn = document.getElementById('startInventoryCamera');
            const startSpoilageCameraBtn = document.getElementById('startSpoilageCamera');
            const startModalCameraBtn = document.getElementById('startModalCamera');
            
            const captureInventoryBtn = document.getElementById('captureInventoryBtn');
            const captureSpoilageBtn = document.getElementById('captureSpoilageBtn');
            const captureModalBtn = document.getElementById('captureModalBtn');
            
            const analyzeInventoryBtn = document.getElementById('analyzeInventoryBtn');
            const analyzeSpoilageBtn = document.getElementById('analyzeSpoilageBtn');
            const scanModalBtn = document.getElementById('scanModalBtn');
            
            const updateInventoryBtn = document.getElementById('updateInventoryBtn');
            const markSpoiledBtn = document.getElementById('markSpoiledBtn');
            
            let currentStream = null;
            
            // Function to start camera
            async function startCamera(videoElement, placeholder, startBtn, captureBtn, analyzeBtn) {
                try {
                    if (currentStream) {
                        currentStream.getTracks().forEach(track => track.stop());
                    }
                    
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    currentStream = stream;
                    videoElement.srcObject = stream;
                    videoElement.style.display = 'block';
                    placeholder.style.display = 'none';
                    startBtn.style.display = 'none';
                    captureBtn.disabled = false;
                    if (analyzeBtn) analyzeBtn.disabled = false;
                    
                    // For demo purposes, we'll simulate detection boxes after a delay
                    if (videoElement === inventoryCameraFeed || videoElement === modalCameraFeed) {
                        setTimeout(() => {
                            simulateDetectionBoxes(videoElement);
                        }, 2000);
                    }
                } catch (err) {
                    console.error("Camera access error:", err);
                    alert("Could not access the camera. Please ensure you've granted camera permissions.");
                }
            }
            
            // Function to simulate detection boxes (for demo)
            function simulateDetectionBoxes(videoElement) {
                const container = videoElement.parentElement;
                
                // Clear any existing boxes
                const existingBoxes = container.querySelectorAll('.detection-box');
                existingBoxes.forEach(box => box.remove());
                
                // Add some random boxes for demo
                const items = [
                    { name: 'Tomatoes', count: 5, confidence: 0.92, color: '#FF6384' },
                    { name: 'Onions', count: 3, confidence: 0.76, color: '#FFCE56' },
                    { name: 'Chicken', count: 2, confidence: 0.88, color: '#36A2EB' }
                ];
                
                items.forEach(item => {
                    const box = document.createElement('div');
                    box.className = 'detection-box';
                    box.style.borderColor = item.color;
                    
                    // Random position for demo
                    const left = Math.random() * 70 + 10;
                    const top = Math.random() * 70 + 10;
                    const width = Math.random() * 20 + 10;
                    const height = Math.random() * 20 + 10;
                    
                    box.style.left = `${left}%`;
                    box.style.top = `${top}%`;
                    box.style.width = `${width}%`;
                    box.style.height = `${height}%`;
                    
                    const label = document.createElement('div');
                    label.className = 'detection-label';
                    label.textContent = `${item.name} (${item.count})`;
                    label.style.backgroundColor = item.color.replace(')', ', 0.7)');
                    box.appendChild(label);
                    
                    container.appendChild(box);
                });
            }
            
            // Function to capture image from camera
            function captureImage(videoElement, canvasElement, overlay) {
                const context = canvasElement.getContext('2d');
                canvasElement.width = videoElement.videoWidth;
                canvasElement.height = videoElement.videoHeight;
                context.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);
                
                videoElement.style.display = 'none';
                canvasElement.style.display = 'block';
                
                if (overlay) {
                    overlay.style.display = 'flex';
                    setTimeout(() => {
                        overlay.style.display = 'none';
                    }, 2000);
                }
            }
            
            // Function to simulate inventory analysis
            function analyzeInventory() {
                const detectedItemsContainer = document.getElementById('inventoryDetectedItems');
                detectedItemsContainer.innerHTML = '';
                
                const items = [
                    { name: 'Tomatoes', count: 5, confidence: 0.92 },
                    { name: 'Onions', count: 10, confidence: 0.76 },
                    { name: 'Chicken', count: 3, confidence: 0.88 },
                    { name: 'Milk', count: 2, confidence: 0.95 }
                ];
                
                items.forEach(item => {
                    const tag = document.createElement('span');
                    tag.className = `detected-tag ${item.confidence < 0.8 ? 'low-confidence' : ''}`;
                    tag.innerHTML = `${item.name} (${item.count}) <span class="confidence-indicator"></span>`;
                    
                    tag.addEventListener('click', () => {
                        openQuantityModal(item.name, item.count);
                    });
                    
                    detectedItemsContainer.appendChild(tag);
                });
                
                updateInventoryBtn.disabled = false;
            }
            
            // Function to simulate spoilage detection
            function detectSpoilage() {
                const spoilageAlert = document.getElementById('spoilageAlert');
                spoilageAlert.querySelector('p').textContent = '2 tomatoes show signs of spoilage';
                spoilageAlert.style.display = 'flex';
                markSpoiledBtn.disabled = false;
            }
            
            // Function to open quantity adjustment modal
            function openQuantityModal(itemName, quantity) {
                const quantityModal = document.getElementById('quantityModal');
                document.getElementById('quantityItemName').textContent = itemName;
                document.getElementById('quantityInput').value = quantity;
                quantityModal.classList.add('active');
            }
            
            // Event listeners for inventory camera
            startInventoryCameraBtn.addEventListener('click', () => {
                startCamera(inventoryCameraFeed, startInventoryCameraBtn.parentElement, startInventoryCameraBtn, captureInventoryBtn, analyzeInventoryBtn);
            });
            
            captureInventoryBtn.addEventListener('click', () => {
                captureImage(inventoryCameraFeed, inventoryCameraCanvas, inventoryCameraFeed.parentElement.querySelector('.scanning-overlay'));
            });
            
            analyzeInventoryBtn.addEventListener('click', analyzeInventory);
            
            // Event listeners for spoilage camera
            startSpoilageCameraBtn.addEventListener('click', () => {
                startCamera(spoilageCameraFeed, startSpoilageCameraBtn.parentElement, startSpoilageCameraBtn, captureSpoilageBtn, analyzeSpoilageBtn);
            });
            
            captureSpoilageBtn.addEventListener('click', () => {
                captureImage(spoilageCameraFeed, spoilageCameraCanvas, spoilageCameraFeed.parentElement.querySelector('.scanning-overlay'));
            });
            
            analyzeSpoilageBtn.addEventListener('click', detectSpoilage);
            
            // Event listeners for modal camera
            startModalCameraBtn.addEventListener('click', () => {
                startCamera(modalCameraFeed, startModalCameraBtn.parentElement, startModalCameraBtn, captureModalBtn, scanModalBtn);
            });
            
            captureModalBtn.addEventListener('click', () => {
                captureImage(modalCameraFeed, modalCameraCanvas, modalCameraFeed.parentElement.querySelector('.scanning-overlay'));
            });
            
            scanModalBtn.addEventListener('click', () => {
                const overlay = modalCameraFeed.parentElement.querySelector('.scanning-overlay');
                overlay.style.display = 'flex';
                
                setTimeout(() => {
                    overlay.style.display = 'none';
                    const detectedItemsContainer = document.getElementById('modalDetectedItems');
                    detectedItemsContainer.innerHTML = '';
                    
                    const items = [
                        { name: 'Tomatoes', count: 5, confidence: 0.92 },
                        { name: 'Onions', count: 10, confidence: 0.76 },
                        { name: 'Chicken', count: 3, confidence: 0.88 }
                    ];
                    
                    items.forEach(item => {
                        const tag = document.createElement('span');
                        tag.className = `detected-tag ${item.confidence < 0.8 ? 'low-confidence' : ''}`;
                        tag.innerHTML = `${item.name} (${item.count}) <span class="confidence-indicator"></span>`;
                        detectedItemsContainer.appendChild(tag);
                    });
                }, 2000);
            });
            
            // Modal functionality
            const scanModal = document.getElementById('scanModal');
            const scanBtn = document.getElementById('scanInventoryBtn');
            const closeBtns = document.querySelectorAll('.modal-close');
            
            scanBtn.addEventListener('click', () => {
                scanModal.classList.add('active');
            });
            
            closeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('active');
                });
            });
            
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('active');
                }
            });
            
            // Quantity adjustment
            const decreaseQuantityBtn = document.getElementById('decreaseQuantity');
            const increaseQuantityBtn = document.getElementById('increaseQuantity');
            const quantityInput = document.getElementById('quantityInput');
            const saveQuantityBtn = document.getElementById('saveQuantityBtn');
            
            decreaseQuantityBtn.addEventListener('click', () => {
                quantityInput.value = Math.max(0, parseInt(quantityInput.value) - 1);
            });
            
            increaseQuantityBtn.addEventListener('click', () => {
                quantityInput.value = parseInt(quantityInput.value) + 1;
            });
            
            saveQuantityBtn.addEventListener('click', () => {
                document.getElementById('quantityModal').classList.remove('active');
                // In a real app, this would update the inventory
            });
            
            // Generate new menu suggestions
            const generateMenuBtn = document.getElementById('generateMenuBtn');
            generateMenuBtn.addEventListener('click', () => {
                alert('Generating new menu suggestions based on current inventory...');
                // In a real app, this would call an API to get new suggestions
            });
            
            // Update inventory
            updateInventoryBtn.addEventListener('click', () => {
                alert('Inventory updated successfully!');
                updateInventoryBtn.disabled = true;
            });
            
            // Mark items as spoiled
            markSpoiledBtn.addEventListener('click', () => {
                alert('Items marked as spoiled and removed from inventory');
                markSpoiledBtn.disabled = true;
                document.getElementById('spoilageAlert').style.display = 'none';
            });
        });

        // API Configuration
        const API_BASE_URL = 'http://localhost:5000/api';

        // Utility functions for API calls
        async function fetchAPI(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    }
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // Authentication functions
        async function login(email, password) {
            return await fetchAPI('/auth/login', {
                method: 'POST',
                body: JSON.stringify({ email, password })
            });
        }

        // Inventory functions
        async function getInventory() {
            return await fetchAPI('/inventory');
        }

        async function updateInventoryItem(id, data) {
            return await fetchAPI(`/inventory/${id}`, {
                method: 'PUT',
                body: JSON.stringify(data)
            });
        }

        // Menu functions
        async function getMenuSuggestions() {
            return await fetchAPI('/menu/suggestions');
        }

        // Waste tracking functions
        async function getWasteMetrics() {
            return await fetchAPI('/waste/metrics');
        }

        // Initialize dashboard
        async function initializeDashboard() {
            try {
                // Load inventory data
                const inventory = await getInventory();
                updateInventoryDisplay(inventory);

                // Load menu suggestions
                const suggestions = await getMenuSuggestions();
                updateMenuSuggestions(suggestions);

                // Load waste metrics
                const wasteMetrics = await getWasteMetrics();
                updateWasteMetrics(wasteMetrics);
            } catch (error) {
                showError('Failed to load dashboard data');
            }
        }

        // UI update functions
        function updateInventoryDisplay(inventory) {
            const inventoryList = document.querySelector('.inventory-list');
            if (!inventoryList) return;

            inventoryList.innerHTML = inventory.map(item => `
                <li class="inventory-item">
                    <span class="item-name">${item.name}</span>
                    <span class="item-status status-${getStatusClass(item.quantity)}">${item.quantity} ${item.unit}</span>
                </li>
            `).join('');
        }

        function updateMenuSuggestions(suggestions) {
            const menuContainer = document.querySelector('.menu-suggestions');
            if (!menuContainer) return;

            menuContainer.innerHTML = suggestions.map(item => `
                <div class="menu-card">
                    <div class="menu-image" style="background-image: url(${item.image})"></div>
                    <div class="card-header">
                        <h3 class="card-title">${item.name}</h3>
                    </div>
                </div>
            `).join('');
        }

        function updateWasteMetrics(metrics) {
            const wasteStats = document.querySelector('.waste-stats');
            if (!wasteStats) return;

            wasteStats.innerHTML = `
                <div class="stat-value">${metrics.totalWaste}kg</div>
                <div class="stat-label">Total Waste This Week</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${metrics.reductionRate}%"></div>
                </div>
            `;
        }

        function getStatusClass(quantity) {
            if (quantity > 70) return 'good';
            if (quantity > 30) return 'warning';
            return 'danger';
        }

        function showError(message) {
            const alertContainer = document.createElement('div');
            alertContainer.className = 'alert alert-danger';
            alertContainer.innerHTML = `
                <span class="alert-icon">⚠️</span>
                <span>${message}</span>
            `;
            document.querySelector('.container').prepend(alertContainer);
            setTimeout(() => alertContainer.remove(), 5000);
        }

        // Initialize the dashboard when the page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>